(self.webpackChunkuse_wallet_example=self.webpackChunkuse_wallet_example||[]).push([[451],{1187:function(t,e,r){t.exports=r(9640)},9640:function(t,e,r){var n=r(6690).default,i=r(9728).default,s=function(){"use strict";function t(e,r){n(this,t),this.channelName=e,this.onMessage=r,this._installListener(),this._requests=new Map,this._nextId=0,this._defaultTimeout=4e3}return i(t,[{key:"_installListener",value:function(){var t=this;this._listener=function(e){if(e.data&&"string"===typeof e.data){var r;try{if(!(r=JSON.parse(e.data)).channel||r.channel!==t.channelName)return;if("object"!==typeof r.message)return}catch(u){return}if("undefined"!==typeof r.replyId){if("number"!==typeof r.replyId||r.replyId%1!==0)return;var n=t._requests.get(r.replyId);if(n){if(e.origin!==n.targetOrigin)return;clearTimeout(n.timeout),t._requests.delete(r.replyId),n.resolve(r.message)}}else{if("number"!==typeof r.id||r.id%1!==0||!t.onMessage)return;var i=t.channelName,s=r.id,o=e.origin;t.onMessage(r.message,e.origin,e.source,(function(t){var r={channel:i,replyId:s,message:t};e.source.postMessage(JSON.stringify(r),o)}),t)}}},window.addEventListener("message",this._listener)}},{key:"sendMessage",value:function(t,e,r,n){var i;try{i=new URL(r).origin}catch(u){throw new Error("Invalid origin URL")}var s={channel:this.channelName,id:this.getNextId(),message:e};if(n&&n.waitForReply){var o=this;return new Promise((function(e,r){var u=setTimeout((function(){o._requests.get(s.id)&&(o._requests.delete(s.id),r(new Error("Timeout expired for the message response")))}),n&&n.timeout?n.timeout:o._defaultTimeout);o._requests.set(s.id,{timeout:u,resolve:e,targetOrigin:i}),t.postMessage(JSON.stringify(s),i)}))}t.postMessage(JSON.stringify(s),i)}},{key:"close",value:function(){window.removeEventListener("message",this._listener),this._listener=null,delete this._requests}},{key:"getNextId",value:function(){return this._nextId+=1,this._nextId}}]),t}();t.exports=s},4451:function(t,e,r){t.exports=r(6478)},6478:function(t,e,r){var n=r(9778).lW,i=r(4704).default,s=r(7061).default,o=r(7156).default,u=r(6690).default,a=r(9728).default,c=r(5253).openPopup,p=r(6531),l=p.sleep,h=p.prepareTxn,d=r(4233),g=d.Errors,f=d.SignTxnsError,w=r(6151),x=null,m=function(){"use strict";function t(e){u(this,t),x||(x=new w),this.bridge=x,this.timeout=e&&e.timeout?e.timeout:16e5,this.url=e&&e.bridgeUrl?e.bridgeUrl:"https://wallet.myalgo.com/bridge",this.url.endsWith("/")&&(this.url=this.url.slice(0,-1)),this.currentConnectPopup=null,this.currentSigntxPopup=null,this.currentSignLogicSigPopup=null,this.currentTealSignPopup=null,this.currentSignBytesPopup=null,this.options={waitForReply:!0,timeout:this.timeout},this.disableLedgerNano=!(!e||!e.disableLedgerNano)&&e.disableLedgerNano}return a(t,[{key:"connect",value:function(){var t=o(s().mark((function t(){var e,r,n=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{shouldSelectOneAccount:!1,openManager:!1},this.currentConnectPopup&&(this.currentConnectPopup.closed?this.currentConnectPopup=null:this.focusWindow(this.currentConnectPopup)),t.prev=2,this.currentConnectPopup=c(this.url+"/connect.html"),t.next=6,this.waitForWindowToLoad(this.currentConnectPopup);case 6:return t.next=8,this.bridge.sendMessage(this.currentConnectPopup,{method:"unlock",params:Object.assign(e,{disableLedgerNano:this.disableLedgerNano})},this.url,this.options);case 8:if(r=t.sent,this.closeWindow(this.currentConnectPopup),this.currentConnectPopup=null,"error"!==r.status){t.next=13;break}throw new Error(r.message);case 13:return t.abrupt("return",r.data.accounts);case 16:throw t.prev=16,t.t0=t.catch(2),this.closeWindow(this.currentConnectPopup),this.currentConnectPopup=null,t.t0;case 21:case"end":return t.stop()}}),t,this,[[2,16]])})));return function(){return t.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var t=o(s().mark((function t(e,r){var o,u,a,p,l,d;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentSigntxPopup&&(this.currentSigntxPopup.closed?this.currentSigntxPopup=null:this.focusWindow(this.currentSigntxPopup)),o=Array.isArray(e)?Array.from(e).map((function(t){return h(t)})):h(e),t.prev=2,this.currentSigntxPopup=c(this.url+"/signtx.html"),t.next=6,this.waitForWindowToLoad(this.currentSigntxPopup);case 6:return t.next=8,this.bridge.sendMessage(this.currentSigntxPopup,{method:"transaction",params:{txn:o,settings:{disableLedgerNano:this.disableLedgerNano},options:r}},this.url,this.options);case 8:if(u=t.sent,this.closeWindow(this.currentSigntxPopup),this.currentSigntxPopup=null,"error"!==u.status){t.next=13;break}throw new Error(u.message);case 13:if(!Array.isArray(u.data)){t.next=18;break}a=[],p=i(u.data);try{for(p.s();!(l=p.n()).done;)(d=l.value).blob=new Uint8Array(n.from(d.blob,"hex")),a.push(d)}catch(s){p.e(s)}finally{p.f()}return t.abrupt("return",a);case 18:return u.data.blob=new Uint8Array(n.from(u.data.blob,"hex")),t.abrupt("return",u.data);case 22:throw t.prev=22,t.t0=t.catch(2),this.closeWindow(this.currentSigntxPopup),this.currentSigntxPopup=null,t.t0;case 27:case"end":return t.stop()}}),t,this,[[2,22]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"signTxns",value:function(){var t=o(s().mark((function t(e,r){var i,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentSigntxPopup&&(this.currentSigntxPopup.closed?this.currentSigntxPopup=null:this.focusWindow(this.currentSigntxPopup)),t.prev=1,i=e,Array.isArray(e)||(i=[e]),this.currentSigntxPopup=c(this.url+"/signtx.html"),t.next=7,this.waitForWindowToLoad(this.currentSigntxPopup);case 7:return t.next=9,this.bridge.sendMessage(this.currentSigntxPopup,{method:"signTxns",params:{txns:i,settings:{disableLedgerNano:this.disableLedgerNano},opts:r}},this.url,this.options);case 9:if(o=t.sent,this.closeWindow(this.currentSigntxPopup),this.currentSigntxPopup=null,"error"!==o.status){t.next=14;break}throw new f(o.message,o.code,o.data);case 14:return t.abrupt("return",o.data.map((function(t){return t?n.from(t.blob,"hex").toString("base64"):null})));case 17:throw t.prev=17,t.t0=t.catch(1),this.closeWindow(this.currentSigntxPopup),this.currentSigntxPopup=null,t.t0;case 22:case"end":return t.stop()}}),t,this,[[1,17]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"signLogicSig",value:function(){var t=o(s().mark((function t(e,r){var i,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentSignLogicSigPopup&&(this.currentSignLogicSigPopup.closed?this.currentSignLogicSigPopup=null:this.focusWindow(this.currentSignLogicSigPopup)),t.prev=1,this.currentSignLogicSigPopup=c(this.url+"/logicsigtx.html"),t.next=5,this.waitForWindowToLoad(this.currentSignLogicSigPopup);case 5:return i=e,e.constructor===Uint8Array&&(i=n.from(e).toString("base64")),t.next=9,this.bridge.sendMessage(this.currentSignLogicSigPopup,{method:"logicsig",params:{logic:i,address:r}},this.url,this.options);case 9:if(o=t.sent,this.closeWindow(this.currentSignLogicSigPopup),this.currentSignLogicSigPopup=null,"error"!==o.status){t.next=14;break}throw new Error(o.message);case 14:return t.abrupt("return",new Uint8Array(n.from(o.data.signedTeal,"base64")));case 17:throw t.prev=17,t.t0=t.catch(1),this.closeWindow(this.currentSignLogicSigPopup),this.currentSignLogicSigPopup=null,t.t0;case 22:case"end":return t.stop()}}),t,this,[[1,17]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"tealSign",value:function(){var t=o(s().mark((function t(e,r,i){var o,u;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentTealSignPopup&&(this.currentTealSignPopup.closed?this.currentTealSignPopup=null:this.focusWindow(this.currentTealSignPopup)),t.prev=1,this.currentTealSignPopup=c(this.url+"/tealsign.html"),t.next=5,this.waitForWindowToLoad(this.currentTealSignPopup);case 5:return o=e,e.constructor===Uint8Array&&(o=n.from(e).toString("base64")),t.next=9,this.bridge.sendMessage(this.currentTealSignPopup,{method:"tealsign",params:{data:o,contractAddress:r,address:i}},this.url,this.options);case 9:if(u=t.sent,this.closeWindow(this.currentTealSignPopup),this.currentTealSignPopup=null,"error"!==u.status){t.next=14;break}throw new Error(u.message);case 14:return t.abrupt("return",new Uint8Array(n.from(u.data.signature,"base64")));case 17:throw t.prev=17,t.t0=t.catch(1),this.closeWindow(this.currentTealSignPopup),this.currentTealSignPopup=null,t.t0;case 22:case"end":return t.stop()}}),t,this,[[1,17]])})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"signBytes",value:function(){var t=o(s().mark((function t(e,r){var i,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentSignBytesPopup&&(this.currentSignBytesPopup.closed?this.currentSignBytesPopup=null:this.focusWindow(this.currentSignBytesPopup)),t.prev=1,this.currentSignBytesPopup=c(this.url+"/signbytes.html"),t.next=5,this.waitForWindowToLoad(this.currentSignBytesPopup);case 5:return i=n.from(e).toString("base64"),t.next=8,this.bridge.sendMessage(this.currentSignBytesPopup,{method:"signbytes",params:{data:i,address:r}},this.url,this.options);case 8:if(o=t.sent,this.closeWindow(this.currentSignBytesPopup),this.currentSignBytesPopup=null,"error"!==o.status){t.next=13;break}throw new Error(o.message);case 13:return t.abrupt("return",new Uint8Array(n.from(o.data.signature,"base64")));case 16:throw t.prev=16,t.t0=t.catch(1),this.closeWindow(this.currentSignBytesPopup),this.currentSignBytesPopup=null,t.t0;case 21:case"end":return t.stop()}}),t,this,[[1,16]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"waitForWindowToLoad",value:function(){var t=o(s().mark((function t(e){var r,n,i=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=i.length>1&&void 0!==i[1]?i[1]:30,n=0;case 2:if(!(n<r)){t.next=20;break}return t.next=5,l(300);case 5:if(e){t.next=7;break}return t.abrupt("break",20);case 7:return t.prev=7,t.next=10,x.sendMessage(e,{method:"status"},this.url);case 10:if("success"!=t.sent.status){t.next=13;break}return t.abrupt("return");case 13:t.next=17;break;case 15:t.prev=15,t.t0=t.catch(7);case 17:n++,t.next=2;break;case 20:throw new Error(g.WINDOW_NOT_LOADED);case 21:case"end":return t.stop()}}),t,this,[[7,15]])})));return function(e){return t.apply(this,arguments)}}()},{key:"closeWindow",value:function(t){t&&!t.closed&&t.close&&t.close()}},{key:"focusWindow",value:function(t){throw t&&t.focus?(t.focus(),new Error(g.WINDOW_IS_OPENED)):new Error(g.INVALID_WINDOW)}}]),t}();t.exports=m},6151:function(t,e,r){var n=r(6690).default,i=r(9728).default,s=r(1187),o=function(){"use strict";function t(e){n(this,t);var r=this;this.options={waitForReply:!0,timeout:250},this.listenerCallback=e,this.bridge=new s("wallet-bridge-communication-channel",(function(t,e,n,i){r.listenerCallback&&r.listenerCallback(t,n)}))}return i(t,[{key:"sendMessage",value:function(t,e,r,n){return this.bridge.sendMessage(t,e,r,n||this.options)}},{key:"setNewListener",value:function(t){this.listenerCallback=t}},{key:"close",value:function(){this.bridge.close()}}]),t}();t.exports=o},5253:function(t,e,r){var n=r(4233).WINDOW_NOT_OPENED,i={width:400,height:600};t.exports={openPopup:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,r=e,s=r.name,o=void 0===s?"":s,u=r.width,a=r.height,c=r.top,p=void 0===c?0:c,l=r.left,h=void 0===l?0:l;u&&(window.outerWidth?h=Math.round((window.outerWidth-u)/2)+window.screenX:window.screen.width&&(h=Math.round((window.screen.width-u)/2))),a&&(window.outerHeight?p=Math.round((window.outerHeight-a)/2)+window.screenY:window.screen.height&&(p=Math.round((window.screen.height-a)/2))),u&&a&&(e={top:p,left:h,width:u,height:a,status:1,toolbar:0,menubar:0,resizable:1,scrollbars:1});var d,g=Object.keys(e).map((function(t){var r=e[t];if(null!==r&&void 0!==r&&"function"===typeof r.toString)return"".concat(t,"=").concat(r.toString())})).filter(Boolean).join(",");try{d=window.open(t,o,g)}catch(f){throw new Error("".concat(n," - ").concat(f.stack||f.message))}if(!d||window.closed)throw new Error("".concat(n," - blocked"));return d}}},4233:function(t,e,r){var n=r(9728).default,i=r(6690).default,s=r(1655).default,o=r(6389).default,u=function(t){"use strict";s(r,t);var e=o(r);function r(t,n,s){var o;return i(this,r),(o=e.call(this,t)).code=n,o.data=s,o}return n(r)}((0,r(3496).default)(Error));t.exports={ERRORS:{WINDOW_NOT_LOADED:"Window not loaded",WINDOW_IS_OPENED:"Windows is opened",WINDOW_NOT_OPENED:"Can not open popup window",INVALID_WINDOW:"Invalid window"},SignTxnsError:u}},6531:function(t,e,r){var n=r(9778).lW;t.exports={sleep:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;return new Promise((function(e){return setTimeout(e,t)}))},prepareTxn:function(t){if(t.constructor===Uint8Array)return n.from(t).toString("base64");if("string"===typeof t)return t;var e=Object.assign({},t);if(e.note&&e.note.constructor===Uint8Array&&(e.note=n.from(e.note).toString("base64")),e.assetMetadataHash&&e.assetMetadataHash.constructor===Uint8Array&&(e.assetMetadataHash=n.from(e.assetMetadataHash).toString("base64")),e.group&&e.group.constructor===Uint8Array&&(e.group=n.from(e.group).toString("base64")),"appl"===e.type&&e.appApprovalProgram&&e.appApprovalProgram.constructor===Uint8Array&&(e.appApprovalProgram=n.from(e.appApprovalProgram).toString("base64")),"appl"===e.type&&e.appClearProgram&&e.appClearProgram.constructor===Uint8Array&&(e.appClearProgram=n.from(e.appClearProgram).toString("base64")),"appl"===e.type&&e.appArgs&&e.appArgs.length>0)for(var r=0;r<e.appArgs.length;r++)e.appArgs[r].constructor===Uint8Array&&(e.appArgs[r]=n.from(e.appArgs[r]).toString("base64"));return e}}},3515:function(t,e,r){var n=r(6015),i=r(9617);function s(e,r,o){return i()?(t.exports=s=Reflect.construct.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=s=function(t,e,r){var i=[null];i.push.apply(i,e);var s=new(Function.bind.apply(t,i));return r&&n(s,r.prototype),s},t.exports.__esModule=!0,t.exports.default=t.exports),s.apply(null,arguments)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},4704:function(t,e,r){var n=r(6116);t.exports=function(t,e){var r="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=n(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){a=!0,o=t},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw o}}}},t.exports.__esModule=!0,t.exports.default=t.exports},6035:function(t){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},t.exports.__esModule=!0,t.exports.default=t.exports},3496:function(t,e,r){var n=r(3808),i=r(6015),s=r(6035),o=r(3515);function u(e){var r="function"===typeof Map?new Map:void 0;return t.exports=u=function(t){if(null===t||!s(t))return t;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return o(t,arguments,n(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},t.exports.__esModule=!0,t.exports.default=t.exports,u(e)}t.exports=u,t.exports.__esModule=!0,t.exports.default=t.exports}}]);
//# sourceMappingURL=451.3b476674.chunk.js.map